<div class="bank-account-container" *ngIf="!loading">
  <div class="header">
    <button class="back-btn" (click)="goBack()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    <h1 class="title">Cuenta Bancaria</h1>
  </div>

  <div class="content">
    <p class="description">
      Conecta tu cuenta bancaria para recibir pagos de tus suscriptores de forma segura.
    </p>

    <form class="form" (ngSubmit)="save()">
      <div class="form-group">
        <label class="form-label">Nombre del Banco<span class="required">*</span></label>
        <select
          class="form-input"
          [class.error]="errors.bank_name && touched.bank_name"
          [(ngModel)]="formData.bank_name"
          (ngModelChange)="validateBankName()"
          (blur)="onFieldBlur('bank_name')"
          name="bank_name"
          required
        >
          <option value="" disabled selected>Selecciona un banco</option>
          <option *ngFor="let bank of colombianBanks" [value]="bank">{{ bank }}</option>
        </select>
        <div *ngIf="errors.bank_name && touched.bank_name" class="field-error">
          {{ errors.bank_name }}
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Tipo de cuenta<span class="required">*</span></label>
        <div class="button-group">
          <button
            type="button"
            class="option-btn"
            [class.active]="formData.account_type === 'corriente'"
            (click)="formData.account_type = 'corriente'"
          >
            Corriente
          </button>
          <button
            type="button"
            class="option-btn"
            [class.active]="formData.account_type === 'ahorros'"
            (click)="formData.account_type = 'ahorros'"
          >
            Ahorros
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Número de cuenta<span class="required">*</span></label>
        <input
          type="text"
          class="form-input"
          [class.error]="errors.account_number && touched.account_number"
          placeholder="304590569045"
          [(ngModel)]="formData.account_number"
          (ngModelChange)="validateAccountNumber()"
          (blur)="onFieldBlur('account_number')"
          (keypress)="onlyNumbers($event)"
          name="account_number"
          inputmode="numeric"
          pattern="[0-9]*"
          required
        />
        <div *ngIf="errors.account_number && touched.account_number" class="field-error">
          {{ errors.account_number }}
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">SWIFT/BIC</label>
        <input
          type="text"
          class="form-input"
          placeholder="COLOCOBMXXX"
          [(ngModel)]="formData.swift_bic"
          name="swift_bic"
        />
      </div>

      <div class="form-group">
        <label class="form-label">Nombre del Titular<span class="required">*</span></label>
        <input
          type="text"
          class="form-input"
          [class.error]="errors.owner_name && touched.owner_name"
          placeholder="Andrés Quintero"
          [(ngModel)]="formData.owner_name"
          (ngModelChange)="validateOwnerName()"
          (blur)="onFieldBlur('owner_name')"
          name="owner_name"
          required
        />
        <div *ngIf="errors.owner_name && touched.owner_name" class="field-error">
          {{ errors.owner_name }}
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="saving">
        {{ saving ? 'Guardando...' : 'Guardar' }}
      </button>
    </form>
  </div>
</div>

<div class="loading-state" *ngIf="loading">
  <div class="spinner"></div>
  <p>Cargando...</p>
</div>
