<div class="subscriptions-container" *ngIf="!isLoading">
  <header class="header">
    <button (click)="goBack()" class="back-button">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
    <h1 class="header-title">Mis suscripciones</h1>
  </header>

  <main class="container mx-auto px-4 py-6">
      <div class="mx-auto max-w-md space-y-4">
        <!-- Summary Card -->
        <div class="card gradient-purple border-none">
          <div class="card-content pt-6">
            <div class="space-y-1">
              <p class="opacity-90 text-white">Total de Suscripciones</p>
              <p class="text-3xl font-bold font-display text-white">{{ subscriptions.length }}</p>
              <p class="opacity-80 text-white">
                {{ subscriptions.length }} con facturas pendientes
              </p>
            </div>
          </div>
        </div>

        <!-- Subscriptions List -->
        <div class="space-y-3">
          <div 
            *ngFor="let subscription of subscriptions"
            class="card card-hover"
            (click)="viewDetail(subscription.id!)"
          >
            <div class="card-header pb-3">
              <div class="flex items-center justify-between gap-3">
                <div class="flex items-center gap-4 flex-1 min-w-0">
                    <img
                      [src]="subscription.business?.logo" 
                      alt="{{ subscription.business?.name }}" 
                      class="h-10 w-10 object-cover rounded">
                  <h3 class="subscription-title">{{ subscription.business?.name }}</h3>
                </div>
                <svg class="h-5 w-5 text-muted-foreground flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path d="M9 5l7 7-7 7" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </div>
            </div>
            <div class="card-content space-y-3">
              <div class="flex items-center justify-between text-xl">
                <span class="text-muted-foreground">Mensualidad</span>
                <span class="font-semibold price-text font-display">
                  {{ formatCurrency(subscription.plan?.price!) }}
                </span>
              </div>

              <div class="flex items-center justify-between text-sm">
                <div class="flex items-center gap-2 text-muted-foreground">
                  <svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <rect x="3" y="4" width="18" height="18" rx="2" stroke-width="2"/>
                    <path d="M16 2v4M8 2v4M3 10h18" stroke-width="2"/>
                  </svg>
                  <span>Desde {{ subscription.startDate! }}</span>
                </div>
                <span 
                  class="badge"
                  [class.badge-active]="subscription.status === 'renewal'"
                  [class.badge-secondary]="subscription.status !== 'renewal'"
                >
                  {{ formatStatus(subscription.status!) }}
                </span>
              </div>

              <div *ngIf="subscriptions.length > 0" class="pt-2 border-t">
                <div class="flex items-center justify-between">
                  <span class="font-medium text-destructive text-red-500">
                    {{ subscriptions.length }} 
                    {{ subscriptions.length === 1 ? 'factura pendiente' : 'facturas pendientes' }}
                  </span>
                  <svg class="h-4 w-4 text-destructive" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <rect x="2" y="5" width="20" height="14" rx="2" stroke-width="2"/>
                    <path d="M2 10h20" stroke-width="2"/>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
</div>

<div class="loading-container" *ngIf="isLoading">
  <div class="spinner"></div>
</div>
