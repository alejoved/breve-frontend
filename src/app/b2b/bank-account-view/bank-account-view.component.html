<div class="bank-account-container" *ngIf="!loading">
  <div class="header">
    <button class="back-btn" (click)="goBack()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    <h1 class="title">Cuenta Bancaria</h1>
  </div>

  <div class="content">
    <p class="description">
      Conecta tu cuenta bancaria para recibir pagos de tus suscriptores de forma segura.
    </p>

    <form class="form" (ngSubmit)="save()">
      <div class="form-group">
        <label class="form-label">Nombre del Banco<span class="required">*</span></label>
        <select
          class="form-input"
          [class.error]="errors.bankName && touched.bankName"
          [(ngModel)]="formData.bankName"
          (ngModelChange)="validateBankName()"
          (blur)="onFieldBlur('bankName')"
          name="bankName"
          required
        >
          <option value="" disabled selected>Selecciona un banco</option>
          <option *ngFor="let bank of colombianBanks" [value]="bank">{{ bank }}</option>
        </select>
        <div *ngIf="errors.bankName && touched.bankName" class="field-error">
          {{ errors.bankName }}
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Tipo de cuenta<span class="required">*</span></label>
        <div class="button-group">
          <button
            type="button"
            class="option-btn"
            [class.active]="formData.accountType === 'corriente'"
            (click)="formData.accountType = 'corriente'"
          >
            Corriente
          </button>
          <button
            type="button"
            class="option-btn"
            [class.active]="formData.accountType === 'ahorros'"
            (click)="formData.accountType = 'ahorros'"
          >
            Ahorros
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Número de cuenta<span class="required">*</span></label>
        <input
          type="text"
          class="form-input"
          [class.error]="errors.accountNumber && touched.accountNumber"
          placeholder="304590569045"
          [(ngModel)]="formData.accountNumber"
          (ngModelChange)="validateAccountNumber()"
          (blur)="onFieldBlur('accountNumber')"
          (keypress)="onlyNumbers($event)"
          name="accountNumber"
          inputmode="numeric"
          pattern="[0-9]*"
          required
        />
        <div *ngIf="errors.accountNumber && touched.accountNumber" class="field-error">
          {{ errors.accountNumber }}
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Nombre del Titular<span class="required">*</span></label>
        <input
          type="text"
          class="form-input"
          [class.error]="errors.accountOwner && touched.accountOwner"
          placeholder="Andrés Quintero"
          [(ngModel)]="formData.accountOwner"
          (ngModelChange)="validateAccountOwner()"
          (blur)="onFieldBlur('accountOwner')"
          name="accountOwner"
          required
        />
        <div *ngIf="errors.accountOwner && touched.accountOwner" class="field-error">
          {{ errors.accountOwner }}
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="saving">
        {{ saving ? 'Guardando...' : 'Guardar' }}
      </button>
    </form>
  </div>
</div>

<div class="loading-state" *ngIf="loading">
  <div class="spinner"></div>
  <p>Cargando...</p>
</div>
