<div class="page-container">
    <app-header [businessName]="businessName"></app-header>

    <div class="content">
    <div class="step-header">
        <h1 class="title">Planes</h1>
        <span class="step-counter">2/6</span>
    </div>

    <app-progress-bar [currentStep]="2" [totalSteps]="6"></app-progress-bar>

    <p class="description">
        Elige el plan que mejor se adapte a tus necesidades
    </p>

    <div class="plans-list">
      <div
        *ngFor="let plan of plans"
        class="plan-card"
        [class.selected]="isSelected(plan.id!)"
        [class.popular]="plan.popular"
        (click)="selectPlan(plan)"
      >
        <!-- Popular Badge -->
        <div *ngIf="plan.popular" class="badge">Recomendado</div>

        <div class="card-content">
          <!-- Plan Header -->
          <div class="plan-header">
            <h3 class="plan-name">{{ plan.name }}</h3>
          </div>

          <!-- Price -->
          <div class="price-container">
            <span class="currency">$</span>
            <span class="price">{{ plan.price!.toFixed(2) }}</span>
            <span class="period">/ {{ plan.type! }}</span>
          </div>

          <!-- Separator Line -->
          <div class="separator"></div>

          <!-- Features -->
          <div class="features-section">
            <p class="features-title">¿Qué incluye?</p>
            <ul class="features-list">
              <li *ngFor="let feature of getVisibleFeatures(plan)" class="feature-item">
                <svg
                  class="check-icon"
                  xmlns="http://www.w3.org/2000/svg"
                  width="14"
                  height="14"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span class="feature-text">{{ feature }}</span>
              </li>
            </ul>
          </div>

          <!-- Button Ver más -->
          <button
            *ngIf="hasMoreFeatures(plan)"
            class="toggle-button"
            (click)="toggleExpanded($event, plan.id!)"
          >
            {{ isExpanded(plan.id!) ? 'Ver menos' : 'Ver más' }}
            <svg
              class="chevron-icon"
              [class.rotated]="isExpanded(plan.id!)"
              xmlns="http://www.w3.org/2000/svg"
              width="12"
              height="12"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <button
        type="button"
        class="btn-continue"
        [disabled]="!selectedPlan"
        (click)="onContinue()"
    >
        Continuar
    </button>
    </div>
</div>